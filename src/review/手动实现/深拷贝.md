---
nav:
  title: Review
  path: /review
---

## 深拷贝

### 基础知识

  js数据类型： Number、String、Boolean、Null、Undefined、Symbol、Object

  其中前六种为原始数据类型，Object为引用数据类型

  Object又可分为 Array、Function、RegExp、Date 等对象

  简单（原始）数据类型在栈存储空间的存储的是一个值，复杂（引用）数据类型在内存中存储的是堆的引用地址，数据存储在堆中

  因为存储方式的不同，导致浅拷贝、深拷贝的不同


### 具体实现

一、序列化与反序列化

JSON.parse(JSON.stringify)

问题：只支持符合JSON类型的数据或值，对于 Function 、RegExp 、Date 都不支持，会被直接忽略

二、手动实现

```js
function cloneDeep(data){
  //如果是Object
  if(data instanceof Object){
    let result 
    if(data instanceof Array){ //for in 在遍历数组时,会将下标作为key，["a","b"]-->{0:"a",1:"b"}
      result = [];
    } else if(data instanceof Function){ //函数功能的重新实现
      result = function(){
        return data.call(this, ...arguments); 
      }
    } else if(data instanceof RegExp){ //函数功能的重新实现
      result = new RegExp(target.source,target.flags);
    } else if(target instanceof Date){
      result = new Date(target);
    } else {
      result = {} 
    }
    //遍历对象每一个Key
    for(let key in data){
      if(data.hasOwnProperty(key)){ //只拷贝自身属性，不遍历原型链上的key
        result[key] = deepClone(data[key]);
      }
    }
    return result
  }else {
    return data; //如果是非Object类型（是简单类型），直接返回
  }
}

```
